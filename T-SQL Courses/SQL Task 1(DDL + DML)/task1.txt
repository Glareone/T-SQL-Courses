Фискальный год, финансовый год  — традиционный период времени, на который устанавливается годовой бюджет юридических лиц в США.
В компании Bluestem Brands Inc. границы фискального года плавающие и отличаются от границ календарного года. Первый день фискального года определяется следующим образом:

Если пятая суббота в календарном году приходится на 29-й день в календарном году или позже, то началом фискального года считается пятая суббота. Иначе началом года считается шестая суббота календарного года.
Соответственно концом предыдущего фискального года будет день, предшествующий первому дню текущего фискального года, т.е. пятая или шестая пятница в календарном году.
В фискальном году может быть 364 либо 371 день.

Фискальный месяц в компании также не совпадает с календарным. Конец фискального месяца выпадает на следующие "магические" дни в фискальном году(в скобках указан номер фискальной недели(т.е. номер недели с начала фискального года), 
конец фискального месяца всегда пятница):
28 (4)
63 (9)
91 (13)
119(17)
154(22)
182(26)
210(30)
245(35)
273(39)
301(43)
336(48)
364(52) или 371(53)

Требуется создать и заполнить таблицу DateDim, в которой будет находиться информация о датах с 2002-02-02 по 2014-01-31 включительно. 
Все ограничения по допустимым значениям должны быть реализованы как CHECK ограничения.
Таблица будет содержать следующие колонки:

1. DateKey - целочисленное поле. Первичный ключ в таблице. Содержит значения в формате YYYYMMDD. Создать кластерный индекс по этой колонке.
2. CalendarDate - поле типа DATE. Альтернативый ключ в таблице. Создать уникальный индекс по этой колонке.
3. CalendarDayInWeekName - поле типа varchar(10). Содержит ангийское название дня недели. Допустимые значения - Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday
4. CalendarDayInMonthNumber - целочисленное поле. Порядковый номер дня в календарном месяце. Допустимые значения - 1-31 
5. CalendarDayInYearNumber- целочисленное поле. Порядковый номер дня в календарном году. Допустимые значения - 1-366 
6. CalendarWeekInYearNumber - порядковый номер недели в календарном месяце. Допустимые значения 1-53
7. CalendarMonthNumber - порядковый номер месяца в календарном году. Допустимые значения 1-12 
8. CalendarQuarter - порядковый номер квартала в календарном году. Допустимые значения 1-5 
9. CalendarYear - календарный год
10. CalendarMonthStartFlag - битовое поле. 1, если день приходится на начало календарного месяца, иначе 0.
11. CalendarMonthEndFlag - битовое поле. 1, если день приходится на конец календарного месяца, иначе 0. 
12. CalendarMonthStartDate - поле типа DATE. Дата начала календарного месяца, к которому принадлежит текущая дата. 
13. CalendarMonthEndDate - поле типа DATE. Дата окончания календарного месяца, к которому принадлежит текущая дата. 
14. FiscalDayInYearNumber- целочисленное поле. Порядковый номер дня в фискальном году. Допустимые значения - 1-371 
15. FiscalWeekInYearNumber - порядковый номер недели в фискальном месяце. Допустимые значения 1-53
16. FiscalMonthNumber - порядковый номер месяца в фискальном году. Допустимые значения 1-12 
17. FiscalQuarter - порядковый номер квартала в фискальном году. Допустимые значения 1-5 
18. FiscalYear - фискальный год
19. FiscalMonthStartFlag - битовое поле. 1, если день приходится на начало фискального месяца, иначе 0.
20. FiscalMonthEndFlag - битовое поле. 1, если день приходится на конец фискального месяца, иначе 0. 
21. FiscalMonthStartDate - поле типа DATE. Дата начала фискального месяца, к которому принадлежит текущая дата. 
22. FiscalMonthEndDate - поле типа DATE. Дата окончания фискального месяца, к которому принадлежит текущая дата. 
23. RelativeDay - целочисленное поле. количество дней от\до сегодняшней даты. 0 для сегодняшнего дня, отрицательное значение для прошлых дат, положительное - для будущих.
24. RelativeWeek - целочисленное поле. количество недель от\до сегодняшней даты. 0 для текущей недели, отрицательное значение для прошлых дат, положительное - для будущих.

